(function(b){function c(v,x){var w=this,s=v.add(w),h=b(window),r,u,q,t=b.tools.expose&&(x.mask||x.expose),l=Math.random().toString().slice(10);if(t){if(typeof t=="string"){t={color:t}}t.closeOnClick=t.closeOnEsc=false}var a=x.target||v.attr("rel");u=a?b(a):v;if(!u.length){throw"Could not find Overlay: "+a}v&&v.index(u)==-1&&v.click(function(f){w.load(f);return f.preventDefault()});b.extend(w,{load:function(o){if(w.isOpened()){return w}var k=e[x.effect];if(!k){throw'Overlay: cannot find effect : "'+x.effect+'"'}x.oneInstance&&b.each(d,function(){this.close(o)});o=o||b.Event();o.type="onBeforeLoad";s.trigger(o);if(o.isDefaultPrevented()){return w}q=true;t&&b(u).expose(t);var j=x.top,m=x.left,g=u.outerWidth({margin:true}),f=u.outerHeight({margin:true});if(typeof j=="string"){j=j=="center"?Math.max((h.height()-f)/2,0):parseInt(j,10)/100*h.height()}if(m=="center"){m=Math.max((h.width()-g)/2,0)}k[0].call(w,{top:j,left:m},function(){if(q){o.type="onLoad";s.trigger(o)}});t&&x.closeOnClick&&b.mask.getMask().one("click",w.close);x.closeOnClick&&b(document).bind("click."+l,function(p){b(p.target).parents(u).length||w.close(p)});x.closeOnEsc&&b(document).bind("keydown."+l,function(p){p.keyCode==27&&w.close(p)});return w},close:function(f){if(!w.isOpened()){return w}f=f||b.Event();f.type="onBeforeClose";s.trigger(f);if(!f.isDefaultPrevented()){q=false;e[x.effect][1].call(w,function(){f.type="onClose";s.trigger(f)});b(document).unbind("click."+l).unbind("keydown."+l);t&&b.mask.close();return w}},getOverlay:function(){return u},getTrigger:function(){return v},getClosers:function(){return r},isOpened:function(){return q},getConf:function(){return x}});b.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(g,f){b.isFunction(x[f])&&b(w).bind(f,x[f]);w[f]=function(j){j&&b(w).bind(f,j);return w}});r=u.find(x.close||".close");if(!r.length&&!x.close){r=b('<a class="close"></a>');u.prepend(r)}r.click(function(f){w.close(f)});x.load&&w.load()}b.tools=b.tools||{version:"1.2.5"};b.tools.overlay={addEffect:function(f,a,g){e[f]=[a,g]},conf:{close:null,closeOnClick:true,closeOnEsc:true,closeSpeed:"fast",effect:"default",fixed:!b.browser.msie||b.browser.version>6,left:"center",load:false,mask:null,oneInstance:true,speed:"normal",target:null,top:"10%"}};var d=[],e={};b.tools.overlay.addEffect("default",function(g,a){var h=this.getConf(),f=b(window);if(!h.fixed){g.top+=f.scrollTop();g.left+=f.scrollLeft()}g.position=h.fixed?"fixed":"absolute";this.getOverlay().css(g).fadeIn(h.speed,a)},function(a){this.getOverlay().fadeOut(this.getConf().closeSpeed,a)});b.fn.overlay=function(f){var a=this.data("overlay");if(a){return a}if(b.isFunction(f)){f={onBeforeLoad:f}}f=b.extend(true,{},b.tools.overlay.conf,f);this.each(function(){a=new c(b(this),f);d.push(a);b(this).data("overlay",a)});return f.api?a:this}})(jQuery);(function(b){var a=b.tools.overlay;a.plugins=a.plugins||{};a.plugins.gallery={version:"1.0.0",conf:{imgId:"img",next:".next",prev:".prev",info:".info",progress:".progress",disabledClass:"disabled",activeClass:"active",opacity:0.8,speed:"slow",template:"<strong>${title}</strong> <span>Image ${index} of ${total}</span>",autohide:true,preload:true,api:false}};b.fn.gallery=function(d){var p=b.extend({},a.plugins.gallery.conf),m;b.extend(p,d);m=this.overlay();console.log(m);var s=this,j=m.getOverlay(),k=j.find(p.next),g=j.find(p.prev),e=j.find(p.info),c=j.find(p.progress),h=g.add(k).add(e).css({opacity:p.opacity}),t=m.getClosers(),l;function q(v){c.fadeIn();h.hide();t.hide();var u=v.attr("href");console.log(u);var w=new Image();w.onload=function(){c.fadeOut();var z=b("#"+p.imgId,j);if(!z.length){z=b("<img/>").attr("id",p.imgId).css("visibility","hidden");j.prepend(z)}z.attr("src",u).css("visibility","hidden");var A=w.width;var B=(b(window).width()-A)/2;l=s.index(s.filter('[href="'+u+'"]'));s.removeClass(p.activeClass).eq(l).addClass(p.activeClass);var x=p.disabledClass;h.removeClass(x);if(l===0){g.addClass(x)}if(l==s.length-1){k.addClass(x)}var C=p.template.replace("${title}",v.attr("title")||v.data("title")).replace("${index}",l+1).replace("${total}",s.length);var y=parseInt(e.css("paddingLeft"),10)+parseInt(e.css("paddingRight"),10);e.html(C).css({width:A-y});j.animate({width:A,height:w.height,left:B},p.speed,function(){z.hide().css("visibility","visible").fadeIn(function(){if(!p.autohide){h.fadeIn();t.show()}})})};w.onerror=function(){j.fadeIn().html("Cannot find image "+u)};w.src=u;if(p.preload){s.filter(":eq("+(l-1)+"), :eq("+(l+1)+")").each(function(){var x=new Image();console.log(this);x.src=b(this).attr("href")})}}function f(u,v){u.click(function(){if(u.hasClass(p.disabledClass)){return}var w=s.eq(i=l+(v?1:-1));if(w.length){q(w)}})}f(k,true);f(g);b(document).keydown(function(u){if(!j.is(":visible")||u.altKey||u.ctrlKey){return}if(u.keyCode==37||u.keyCode==39){var v=u.keyCode==37?g:k;v.click();return u.preventDefault()}return true});function r(){if(!j.is(":animated")){h.show();t.show()}}if(p.autohide){j.hover(r,function(){h.fadeOut();t.hide()}).mousemove(r)}var o;this.each(function(){console.log(this);var w=b(this),v=b(this).overlay(),u=v;v.onBeforeLoad(function(){q(w)});v.onClose(function(){s.removeClass(p.activeClass)})});return p.api?o:this}})(jQuery);
/*!
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(d,b){function a(c){return !d(c).parents().andSelf().filter(function(){return d.curCSS(this,"visibility")==="hidden"||d.expr.filters.hidden(this)}).length}d.ui=d.ui||{};if(!d.ui.version){d.extend(d.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});d.fn.extend({_focus:d.fn.focus,focus:function(e,c){return typeof e==="number"?this.each(function(){var f=this;setTimeout(function(){d(f).focus();c&&c.call(f)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var c;c=d.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(d.curCSS(this,"position",1))&&/(auto|scroll)/.test(d.curCSS(this,"overflow",1)+d.curCSS(this,"overflow-y",1)+d.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(d.curCSS(this,"overflow",1)+d.curCSS(this,"overflow-y",1)+d.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!c.length?d(document):c},zIndex:function(e){if(e!==b){return this.css("zIndex",e)}if(this.length){e=d(this[0]);for(var c;e.length&&e[0]!==document;){c=e.css("position");if(c==="absolute"||c==="relative"||c==="fixed"){c=parseInt(e.css("zIndex"),10);if(!isNaN(c)&&c!==0){return c}}e=e.parent()}}return 0},disableSelection:function(){return this.bind((d.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(c){c.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});d.each(["Width","Height"],function(f,c){function l(p,o,h,e){d.each(k,function(){o-=parseFloat(d.curCSS(p,"padding"+this,true))||0;if(h){o-=parseFloat(d.curCSS(p,"border"+this+"Width",true))||0}if(e){o-=parseFloat(d.curCSS(p,"margin"+this,true))||0}});return o}var k=c==="Width"?["Left","Right"]:["Top","Bottom"],j=c.toLowerCase(),g={innerWidth:d.fn.innerWidth,innerHeight:d.fn.innerHeight,outerWidth:d.fn.outerWidth,outerHeight:d.fn.outerHeight};d.fn["inner"+c]=function(e){if(e===b){return g["inner"+c].call(this)}return this.each(function(){d(this).css(j,l(this,e)+"px")})};d.fn["outer"+c]=function(h,e){if(typeof h!=="number"){return g["outer"+c].call(this,h)}return this.each(function(){d(this).css(j,l(this,h,true,e)+"px")})}});d.extend(d.expr[":"],{data:function(e,c,f){return !!d.data(e,f[3])},focusable:function(e){var c=e.nodeName.toLowerCase(),f=d.attr(e,"tabindex");if("area"===c){c=e.parentNode;f=c.name;if(!e.href||!f||c.nodeName.toLowerCase()!=="map"){return false}e=d("img[usemap=#"+f+"]")[0];return !!e&&a(e)}return(/input|select|textarea|button|object/.test(c)?!e.disabled:"a"==c?e.href||!isNaN(f):!isNaN(f))&&a(e)},tabbable:function(e){var c=d.attr(e,"tabindex");return(isNaN(c)||c>=0)&&d(e).is(":focusable")}});d(function(){var e=document.body,c=e.appendChild(c=document.createElement("div"));d.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});d.support.minHeight=c.offsetHeight===100;d.support.selectstart="onselectstart" in c;e.removeChild(c).style.display="none"});d.extend(d.ui,{plugin:{add:function(f,c,h){f=d.ui[f].prototype;for(var g in h){f.plugins[g]=f.plugins[g]||[];f.plugins[g].push([c,h[g]])}},call:function(f,c,h){if((c=f.plugins[c])&&f.element[0].parentNode){for(var g=0;g<c.length;g++){f.options[c[g][0]]&&c[g][1].apply(f.element,h)}}}},contains:function(e,c){return document.compareDocumentPosition?e.compareDocumentPosition(c)&16:e!==c&&e.contains(c)},hasScroll:function(e,c){if(d(e).css("overflow")==="hidden"){return false}c=c&&c==="left"?"scrollLeft":"scrollTop";var f=false;if(e[c]>0){return true}e[c]=1;f=e[c]>0;e[c]=0;return f},isOverAxis:function(e,c,f){return e>c&&e<c+f},isOver:function(f,c,l,k,j,g){return d.ui.isOverAxis(f,l,j)&&d.ui.isOverAxis(c,k,g)}})}})(jQuery);
/*!
 * jQuery UI Widget 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(a,e){if(a.cleanData){var d=a.cleanData;a.cleanData=function(b){for(var g=0,f;(f=b[g])!=null;g++){a(f).triggerHandler("remove")}d(b)}}else{var c=a.fn.remove;a.fn.remove=function(b,f){return this.each(function(){if(!f){if(!b||a.filter(b,[this]).length){a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")})}}return c.call(a(this),b,f)})}}a.widget=function(b,k,j){var h=b.split(".")[0],g;b=b.split(".")[1];g=h+"-"+b;if(!j){j=k;k=a.Widget}a.expr[":"][g]=function(f){return !!a.data(f,b)};a[h]=a[h]||{};a[h][b]=function(f,l){arguments.length&&this._createWidget(f,l)};k=new k;k.options=a.extend(true,{},k.options);a[h][b].prototype=a.extend(true,k,{namespace:h,widgetName:b,widgetEventPrefix:a[h][b].prototype.widgetEventPrefix||b,widgetBaseClass:g},j);a.widget.bridge(b,a[h][b])};a.widget.bridge=function(b,f){a.fn[b]=function(l){var k=typeof l==="string",j=Array.prototype.slice.call(arguments,1),g=this;l=!k&&j.length?a.extend.apply(null,[true,l].concat(j)):l;if(k&&l.charAt(0)==="_"){return g}k?this.each(function(){var m=a.data(this,b),h=m&&a.isFunction(m[l])?m[l].apply(m,j):m;if(h!==m&&h!==e){g=h;return false}}):this.each(function(){var h=a.data(this,b);h?h.option(l||{})._init():a.data(this,b,new f(l,this))});return g}};a.Widget=function(b,f){arguments.length&&this._createWidget(b,f)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(b,g){a.data(g,this.widgetName,this);this.element=a(g);this.options=a.extend(true,{},this.options,this._getCreateOptions(),b);var f=this;this.element.bind("remove."+this.widgetName,function(){f.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(b,g){var f=b;if(arguments.length===0){return a.extend({},this.options)}if(typeof b==="string"){if(g===e){return this.options[b]}f={};f[b]=g}this._setOptions(f);return this},_setOptions:function(b){var f=this;a.each(b,function(h,g){f._setOption(h,g)});return this},_setOption:function(b,f){this.options[b]=f;if(b==="disabled"){this.widget()[f?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",f)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(b,k,j){var h=this.options[b];k=a.Event(k);k.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();j=j||{};if(k.originalEvent){b=a.event.props.length;for(var g;b;){g=a.event.props[--b];k[g]=k.originalEvent[g]}}this.element.trigger(k,j);return !(a.isFunction(h)&&h.call(this.element[0],k,j)===false||k.isDefaultPrevented())}}})(jQuery);(function(f){f.ui=f.ui||{};var e=/left|center|right/,d=/top|center|bottom/,b=f.fn.position,a=f.fn.offset;f.fn.position=function(c){if(!c||!c.of){return b.apply(this,arguments)}c=f.extend({},c);var l=f(c.of),s=l[0],q=(c.collision||"flip").split(" "),r=c.offset?c.offset.split(" "):[0,0],p,m,o;if(s.nodeType===9){p=l.width();m=l.height();o={top:0,left:0}}else{if(s.setTimeout){p=l.width();m=l.height();o={top:l.scrollTop(),left:l.scrollLeft()}}else{if(s.preventDefault){c.at="left top";p=m=0;o={top:c.of.pageY,left:c.of.pageX}}else{p=l.outerWidth();m=l.outerHeight();o=l.offset()}}}f.each(["my","at"],function(){var g=(c[this]||"").split(" ");if(g.length===1){g=e.test(g[0])?g.concat(["center"]):d.test(g[0])?["center"].concat(g):["center","center"]}g[0]=e.test(g[0])?g[0]:"center";g[1]=d.test(g[1])?g[1]:"center";c[this]=g});if(q.length===1){q[1]=q[0]}r[0]=parseInt(r[0],10)||0;if(r.length===1){r[1]=r[0]}r[1]=parseInt(r[1],10)||0;if(c.at[0]==="right"){o.left+=p}else{if(c.at[0]==="center"){o.left+=p/2}}if(c.at[1]==="bottom"){o.top+=m}else{if(c.at[1]==="center"){o.top+=m/2}}o.left+=r[0];o.top+=r[1];return this.each(function(){var x=f(this),t=x.outerWidth(),k=x.outerHeight(),j=parseInt(f.curCSS(this,"marginLeft",true))||0,h=parseInt(f.curCSS(this,"marginTop",true))||0,z=t+j+(parseInt(f.curCSS(this,"marginRight",true))||0),y=k+h+(parseInt(f.curCSS(this,"marginBottom",true))||0),u=f.extend({},o),g;if(c.my[0]==="right"){u.left-=t}else{if(c.my[0]==="center"){u.left-=t/2}}if(c.my[1]==="bottom"){u.top-=k}else{if(c.my[1]==="center"){u.top-=k/2}}u.left=Math.round(u.left);u.top=Math.round(u.top);g={left:u.left-j,top:u.top-h};f.each(["left","top"],function(w,v){f.ui.position[q[w]]&&f.ui.position[q[w]][v](u,{targetWidth:p,targetHeight:m,elemWidth:t,elemHeight:k,collisionPosition:g,collisionWidth:z,collisionHeight:y,offset:r,my:c.my,at:c.at})});f.fn.bgiframe&&x.bgiframe();x.offset(f.extend(u,{using:c.using}))})};f.ui.position={fit:{left:function(c,g){var h=f(window);h=g.collisionPosition.left+g.collisionWidth-h.width()-h.scrollLeft();c.left=h>0?c.left-h:Math.max(c.left-g.collisionPosition.left,c.left)},top:function(c,g){var h=f(window);h=g.collisionPosition.top+g.collisionHeight-h.height()-h.scrollTop();c.top=h>0?c.top-h:Math.max(c.top-g.collisionPosition.top,c.top)}},flip:{left:function(c,j){if(j.at[0]!=="center"){var o=f(window);o=j.collisionPosition.left+j.collisionWidth-o.width()-o.scrollLeft();var l=j.my[0]==="left"?-j.elemWidth:j.my[0]==="right"?j.elemWidth:0,m=j.at[0]==="left"?j.targetWidth:-j.targetWidth,k=-2*j.offset[0];c.left+=j.collisionPosition.left<0?l+m+k:o>0?l+m+k:0}},top:function(c,j){if(j.at[1]!=="center"){var o=f(window);o=j.collisionPosition.top+j.collisionHeight-o.height()-o.scrollTop();var l=j.my[1]==="top"?-j.elemHeight:j.my[1]==="bottom"?j.elemHeight:0,m=j.at[1]==="top"?j.targetHeight:-j.targetHeight,k=-2*j.offset[1];c.top+=j.collisionPosition.top<0?l+m+k:o>0?l+m+k:0}}}};if(!f.offset.setOffset){f.offset.setOffset=function(c,j){if(/static/.test(f.curCSS(c,"position"))){c.style.position="relative"}var o=f(c),l=o.offset(),m=parseInt(f.curCSS(c,"top",true),10)||0,k=parseInt(f.curCSS(c,"left",true),10)||0;l={top:j.top-l.top+m,left:j.left-l.left+k};"using" in j?j.using.call(c,l):o.css(l)};f.fn.offset=function(c){var g=this[0];if(!g||!g.ownerDocument){return null}if(c){return this.each(function(){f.offset.setOffset(this,c)})}return a.call(this)}}})(jQuery);(function(b){var a=0;b.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var d=this,c=this.element[0].ownerDocument,e;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(h){if(!(d.options.disabled||d.element.attr("readonly"))){e=false;var g=b.ui.keyCode;switch(h.keyCode){case g.PAGE_UP:d._move("previousPage",h);break;case g.PAGE_DOWN:d._move("nextPage",h);break;case g.UP:d._move("previous",h);h.preventDefault();break;case g.DOWN:d._move("next",h);h.preventDefault();break;case g.ENTER:case g.NUMPAD_ENTER:if(d.menu.active){e=true;h.preventDefault()}case g.TAB:if(!d.menu.active){return}d.menu.select(h);break;case g.ESCAPE:d.element.val(d.term);d.close(h);break;default:clearTimeout(d.searching);d.searching=setTimeout(function(){if(d.term!=d.element.val()){d.selectedItem=null;d.search(null,h)}},d.options.delay);break}}}).bind("keypress.autocomplete",function(f){if(e){e=false;f.preventDefault()}}).bind("focus.autocomplete",function(){if(!d.options.disabled){d.selectedItem=null;d.previous=d.element.val()}}).bind("blur.autocomplete",function(f){if(!d.options.disabled){clearTimeout(d.searching);d.closing=setTimeout(function(){d.close(f);d._change(f)},150)}});this._initSource();this.response=function(){return d._response.apply(d,arguments)};this.menu=b("<ul></ul>").addClass("ui-autocomplete").appendTo(b(this.options.appendTo||"body",c)[0]).mousedown(function(h){var g=d.menu.element[0];b(h.target).closest(".ui-menu-item").length||setTimeout(function(){b(document).one("mousedown",function(f){f.target!==d.element[0]&&f.target!==g&&!b.ui.contains(g,f.target)&&d.close()})},1);setTimeout(function(){clearTimeout(d.closing)},13)}).menu({focus:function(h,g){g=g.item.data("item.autocomplete");false!==d._trigger("focus",h,{item:g})&&/^key/.test(h.originalEvent.type)&&d.element.val(g.value)},selected:function(l,k){var j=k.item.data("item.autocomplete"),g=d.previous;if(d.element[0]!==c.activeElement){d.element.focus();d.previous=g;setTimeout(function(){d.previous=g;d.selectedItem=j},1)}false!==d._trigger("select",l,{item:j})&&d.element.val(j.value);d.term=d.element.val();d.close(l);d.selectedItem=j},blur:function(){d.menu.element.is(":visible")&&d.element.val()!==d.term&&d.element.val(d.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");b.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();b.Widget.prototype.destroy.call(this)},_setOption:function(d,c){b.Widget.prototype._setOption.apply(this,arguments);d==="source"&&this._initSource();if(d==="appendTo"){this.menu.element.appendTo(b(c||"body",this.element[0].ownerDocument)[0])}d==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var d=this,c,e;if(b.isArray(this.options.source)){c=this.options.source;this.source=function(h,g){g(b.ui.autocomplete.filter(c,h.term))}}else{if(typeof this.options.source==="string"){e=this.options.source;this.source=function(h,g){d.xhr&&d.xhr.abort();d.xhr=b.ajax({url:e,data:h,dataType:"json",autocompleteRequest:++a,success:function(f){this.autocompleteRequest===a&&g(f)},error:function(){this.autocompleteRequest===a&&g([])}})}}else{this.source=this.options.source}}},search:function(d,c){d=d!=null?d:this.element.val();this.term=this.element.val();if(d.length<this.options.minLength){return this.close(c)}clearTimeout(this.closing);if(this._trigger("search",c)!==false){return this._search(d)}},_search:function(c){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:c},this.response)},_response:function(c){if(!this.options.disabled&&c&&c.length){c=this._normalize(c);this._suggest(c);this._trigger("open")}else{this.close()}this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(c){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",c)}},_change:function(c){this.previous!==this.element.val()&&this._trigger("change",c,{item:this.selectedItem})},_normalize:function(c){if(c.length&&c[0].label&&c[0].value){return c}return b.map(c,function(d){if(typeof d==="string"){return{label:d,value:d}}return b.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(d){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,d);this.menu.deactivate();this.menu.refresh();c.show();this._resizeMenu();c.position(b.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new b.Event("mouseover"))},_resizeMenu:function(){var c=this.menu.element;c.outerWidth(Math.max(c.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(d,c){var e=this;b.each(c,function(h,g){e._renderItem(d,g)})},_renderItem:function(d,c){return b("<li></li>").data("item.autocomplete",c).append(b("<a></a>").text(c.label)).appendTo(d)},_move:function(d,c){if(this.menu.element.is(":visible")){if(this.menu.first()&&/^previous/.test(d)||this.menu.last()&&/^next/.test(d)){this.element.val(this.term);this.menu.deactivate()}else{this.menu[d](c)}}else{this.search(null,c)}},widget:function(){return this.menu.element}});b.extend(b.ui.autocomplete,{escapeRegex:function(c){return c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(d,c){var e=new RegExp(b.ui.autocomplete.escapeRegex(c),"i");return b.grep(d,function(f){return e.test(f.label||f.value||f)})}})})(jQuery);(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){if(a(c.target).closest(".ui-menu-item a").length){c.preventDefault();b.select(c)}});this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(j,f){this.deactivate();if(this.hasScroll()){var d=f.offset().top-this.element.offset().top,h=this.element.attr("scrollTop"),k=this.element.height();if(d<0){this.element.attr("scrollTop",h+d)}else{d>=k&&this.element.attr("scrollTop",h+d-k+f.height())}}this.active=f.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",j,{item:f})},deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null}},next:function(b){this.move("next",".ui-menu-item:first",b)},previous:function(b){this.move("prev",".ui-menu-item:last",b)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(f,d,c){if(this.active){f=this.active[f+"All"](".ui-menu-item").eq(0);f.length?this.activate(c,f):this.activate(c,this.element.children(d))}else{this.activate(c,this.element.children(d))}},nextPage:function(h){if(this.hasScroll()){if(!this.active||this.last()){this.activate(h,this.element.children(".ui-menu-item:first"))}else{var d=this.active.offset().top,c=this.element.height(),f=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-d-c+a(this).height();return b<10&&b>-10});f.length||(f=this.element.children(".ui-menu-item:last"));this.activate(h,f)}}else{this.activate(h,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(f){if(this.hasScroll()){if(!this.active||this.first()){this.activate(f,this.element.children(".ui-menu-item:last"))}else{var d=this.active.offset().top,c=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-d+c-a(this).height();return b<10&&b>-10});result.length||(result=this.element.children(".ui-menu-item:first"));this.activate(f,result)}}else{this.activate(f,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})})(jQuery);(function(c){var a=c.scrollTo=function(f,e,d){c(window).scrollTo(f,e,d)};a.defaults={axis:"xy",duration:parseFloat(c.fn.jquery)>=1.3?0:1};a.window=function(d){return c(window)._scrollable()};c.fn._scrollable=function(){return this.map(function(){var e=this,d=!e.nodeName||c.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!d){return e}var f=(e.contentWindow||e).document||e.ownerDocument||e;return c.browser.safari||f.compatMode=="BackCompat"?f.body:f.documentElement})};c.fn.scrollTo=function(f,e,d){if(typeof e=="object"){d=e;e=0}if(typeof d=="function"){d={onAfter:d}}if(f=="max"){f=9000000000}d=c.extend({},a.defaults,d);e=e||d.speed||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){e/=2}d.offset=b(d.offset);d.over=b(d.over);return this._scrollable().each(function(){var m=this,k=c(m),l=f,j,g={},o=k.is("html,body");switch(typeof l){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(l)){l=b(l);break}l=c(l,this);case"object":if(l.is||l.style){j=(l=c(l)).offset()}}c.each(d.axis.split(""),function(s,t){var u=t=="x"?"Left":"Top",w=u.toLowerCase(),r="scroll"+u,q=m[r],p=a.max(m,t);if(j){g[r]=j[w]+(o?0:q-k.offset()[w]);if(d.margin){g[r]-=parseInt(l.css("margin"+u))||0;g[r]-=parseInt(l.css("border"+u+"Width"))||0}g[r]+=d.offset[w]||0;if(d.over[w]){g[r]+=l[t=="x"?"width":"height"]()*d.over[w]}}else{var v=l[w];g[r]=v.slice&&v.slice(-1)=="%"?parseFloat(v)/100*p:v}if(/^\d+$/.test(g[r])){g[r]=g[r]<=0?0:Math.min(g[r],p)}if(!s&&d.queue){if(q!=g[r]){h(d.onAfterFirst)}delete g[r]}});h(d.onAfter);function h(p){k.animate(g,e,d.easing,p&&function(){p.call(this,f,d)})}}).end()};a.max=function(k,j){var h=j=="x"?"Width":"Height",e="scroll"+h;if(!c(k).is("html,body")){return k[e]-c(k)[h.toLowerCase()]()}var g="client"+h,f=k.ownerDocument.documentElement,d=k.ownerDocument.body;return Math.max(f[e],d[e])-Math.min(f[g],d[g])};function b(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);(function($){$.fn.markItUp=function(settings,extraSettings){var options,ctrlKey,shiftKey,altKey;ctrlKey=shiftKey=altKey=false;options={id:"",nameSpace:"",root:"",previewInWindow:"",previewAutoRefresh:true,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParserPath:"",previewParserVar:"data",resizeHandle:true,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]};$.extend(options,settings,extraSettings);if(!options.root){$("script").each(function(a,tag){miuScript=$(tag).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/);if(miuScript!==null){options.root=miuScript[1]}})}return this.each(function(){var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;$$=$(this);textarea=this;levels=[];abort=false;scrollPosition=caretPosition=0;caretOffset=-1;options.previewParserPath=localize(options.previewParserPath);options.previewTemplatePath=localize(options.previewTemplatePath);function localize(data,inText){if(inText){return data.replace(/("|')~\//g,"$1"+options.root)}return data.replace(/^~\//,options.root)}function init(){id="";nameSpace="";if(options.id){id='id="'+options.id+'"'}else{if($$.attr("id")){id='id="markItUp'+($$.attr("id").substr(0,1).toUpperCase())+($$.attr("id").substr(1))+'"'}}if(options.nameSpace){nameSpace='class="'+options.nameSpace+'"'}$$.wrap("<div "+nameSpace+"></div>");$$.wrap("<div "+id+' class="markItUp"></div>');$$.wrap('<div class="markItUpContainer"></div>');$$.addClass("markItUpEditor");header=$('<div class="markItUpHeader"></div>').insertBefore($$);$(dropMenus(options.markupSet)).appendTo(header);footer=$('<div class="markItUpFooter"></div>').insertAfter($$);if(options.resizeHandle===true&&$.browser.safari!==true){resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown",function(e){var h=$$.height(),y=e.clientY,mouseMove,mouseUp;mouseMove=function(e){$$.css("height",Math.max(20,e.clientY+h-y)+"px");return false};mouseUp=function(e){$("html").unbind("mousemove",mouseMove).unbind("mouseup",mouseUp);return false};$("html").bind("mousemove",mouseMove).bind("mouseup",mouseUp)});footer.append(resizeHandle)}$$.keydown(keyPressed).keyup(keyPressed);$$.bind("insertion",function(e,settings){if(settings.target!==false){get()}if(textarea===$.markItUp.focused){markup(settings)}});$$.focus(function(){$.markItUp.focused=this})}function dropMenus(markupSet){var ul=$("<ul></ul>"),i=0;$("li:hover > ul",ul).css("display","block");$.each(markupSet,function(){var button=this,t="",title,li,j;title=(button.key)?(button.name||"")+" [Ctrl+"+button.key+"]":(button.name||"");key=(button.key)?'accesskey="'+button.key+'"':"";if(button.separator){li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul)}else{i++;for(j=levels.length-1;j>=0;j--){t+=levels[j]+"-"}li=$('<li class="markItUpButton markItUpButton'+t+(i)+" "+(button.className||"")+'"><a href="" '+key+' title="'+title+'">'+(button.name||"")+"</a></li>").bind("contextmenu",function(){return false}).click(function(){return false}).mousedown(function(){if(button.call){eval(button.call)()}setTimeout(function(){markup(button)},1);return false}).hover(function(){$("> ul",this).show();$(document).one("click",function(){$("ul ul",header).hide()})},function(){$("> ul",this).hide()}).appendTo(ul);if(button.dropMenu){levels.push(i);$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu))}}});levels.pop();return ul}function magicMarkups(string){if(string){string=string.toString();string=string.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(x,a){var b=a.split("|!|");if(altKey===true){return(b[1]!==undefined)?b[1]:b[0]}else{return(b[1]===undefined)?"":b[0]}});string=string.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(x,a){var b=a.split(":!:");if(abort===true){return false}value=prompt(b[0],(b[1])?b[1]:"");if(value===null){abort=true}return value});return string}return""}function prepare(action){if($.isFunction(action)){action=action(hash)}return magicMarkups(action)}function build(string){openWith=prepare(clicked.openWith);placeHolder=prepare(clicked.placeHolder);replaceWith=prepare(clicked.replaceWith);closeWith=prepare(clicked.closeWith);if(replaceWith!==""){block=openWith+replaceWith+closeWith}else{if(selection===""&&placeHolder!==""){block=openWith+placeHolder+closeWith}else{block=openWith+(string||selection)+closeWith}}return{block:block,openWith:openWith,replaceWith:replaceWith,placeHolder:placeHolder,closeWith:closeWith}}function markup(button){var len,j,n,i;hash=clicked=button;get();$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:(selection||""),caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey});prepare(options.beforeInsert);prepare(clicked.beforeInsert);if(ctrlKey===true&&shiftKey===true){prepare(clicked.beforeMultiInsert)}$.extend(hash,{line:1});if(ctrlKey===true&&shiftKey===true){lines=selection.split(/\r?\n/);for(j=0,n=lines.length,i=0;i<n;i++){if($.trim(lines[i])!==""){$.extend(hash,{line:++j,selection:lines[i]});lines[i]=build(lines[i]).block}else{lines[i]=""}}string={block:lines.join("\n")};start=caretPosition;len=string.block.length+(($.browser.opera)?n:0)}else{if(ctrlKey===true){string=build(selection);start=caretPosition+string.openWith.length;len=string.block.length-string.openWith.length-string.closeWith.length;len-=fixIeBug(string.block)}else{if(shiftKey===true){string=build(selection);start=caretPosition;len=string.block.length;len-=fixIeBug(string.block)}else{string=build(selection);start=caretPosition+string.block.length;len=0;start-=fixIeBug(string.block)}}}if((selection===""&&string.replaceWith==="")){caretOffset+=fixOperaBug(string.block);start=caretPosition+string.openWith.length;len=string.block.length-string.openWith.length-string.closeWith.length;caretOffset=$$.val().substring(caretPosition,$$.val().length).length;caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))}$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition});if(string.block!==selection&&abort===false){insert(string.block);set(start,len)}else{caretOffset=-1}get();$.extend(hash,{line:"",selection:selection});if(ctrlKey===true&&shiftKey===true){prepare(clicked.afterMultiInsert)}prepare(clicked.afterInsert);prepare(options.afterInsert);if(previewWindow&&options.previewAutoRefresh){refreshPreview()}shiftKey=altKey=ctrlKey=abort=false}function fixOperaBug(string){if($.browser.opera){return string.length-string.replace(/\n*/g,"").length}return 0}function fixIeBug(string){if($.browser.msie){return string.length-string.replace(/\r*/g,"").length}return 0}function insert(block){if(document.selection){var newSelection=document.selection.createRange();newSelection.text=block}else{$$.val($$.val().substring(0,caretPosition)+block+$$.val().substring(caretPosition+selection.length,$$.val().length))}}function set(start,len){if(textarea.createTextRange){if($.browser.opera&&$.browser.version>=9.5&&len==0){return false}range=textarea.createTextRange();range.collapse(true);range.moveStart("character",start);range.moveEnd("character",len);range.select()}else{if(textarea.setSelectionRange){textarea.setSelectionRange(start,start+len)}}textarea.scrollTop=scrollPosition;textarea.focus()}function get(){textarea.focus();scrollPosition=textarea.scrollTop;if(document.selection){selection=document.selection.createRange().text;if($.browser.msie){var range=document.selection.createRange(),rangeCopy=range.duplicate();rangeCopy.moveToElementText(textarea);caretPosition=-1;while(rangeCopy.inRange(range)){rangeCopy.moveStart("character");caretPosition++}}else{caretPosition=textarea.selectionStart}}else{caretPosition=textarea.selectionStart;selection=$$.val().substring(caretPosition,textarea.selectionEnd)}return selection}function preview(){if(!previewWindow||previewWindow.closed){if(options.previewInWindow){previewWindow=window.open("","preview",options.previewInWindow)}else{iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>');if(options.previewPosition=="after"){iFrame.insertAfter(footer)}else{iFrame.insertBefore(header)}previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]}}else{if(altKey===true){if(iFrame){iFrame.remove()}else{previewWindow.close()}previewWindow=iFrame=false}}if(!options.previewAutoRefresh){refreshPreview()}}function refreshPreview(){renderPreview()}function renderPreview(){var phtml;if(options.previewParserPath!==""){$.ajax({type:"POST",url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(data){writeInPreview(localize(data,1))}})}else{if(!template){$.ajax({url:options.previewTemplatePath,success:function(data){writeInPreview(localize(data,1).replace(/<!-- content -->/g,$$.val()))}})}}return false}function writeInPreview(data){if(previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(e){sp=0}previewWindow.document.open();previewWindow.document.write(data);previewWindow.document.close();previewWindow.document.documentElement.scrollTop=sp}if(options.previewInWindow){previewWindow.focus()}}function keyPressed(e){shiftKey=e.shiftKey;altKey=e.altKey;ctrlKey=(!(e.altKey&&e.ctrlKey))?e.ctrlKey:false;if(e.type==="keydown"){if(ctrlKey===true){li=$("a[accesskey="+String.fromCharCode(e.keyCode)+"]",header).parent("li");if(li.length!==0){ctrlKey=false;setTimeout(function(){li.triggerHandler("mousedown")},1);return false}}if(e.keyCode===13||e.keyCode===10){if(ctrlKey===true){ctrlKey=false;markup(options.onCtrlEnter);return options.onCtrlEnter.keepDefault}else{if(shiftKey===true){shiftKey=false;markup(options.onShiftEnter);return options.onShiftEnter.keepDefault}else{markup(options.onEnter);return options.onEnter.keepDefault}}}if(e.keyCode===9){if(shiftKey==true||ctrlKey==true||altKey==true){return false}if(caretOffset!==-1){get();caretOffset=$$.val().length-caretOffset;set(caretOffset,0);caretOffset=-1;return false}else{markup(options.onTab);return options.onTab.keepDefault}}}}init()})};$.fn.markItUpRemove=function(){return this.each(function(){var $$=$(this).unbind().removeClass("markItUpEditor");$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$)})};$.markItUp=function(settings){var options={target:false};$.extend(options,settings);if(options.target){return $(options.target).each(function(){$(this).focus();$(this).trigger("insertion",[options])})}else{$("textarea").trigger("insertion",[options])}}})(jQuery);function parse_url(f,b){var e={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var a=e.parser[e.strictMode?"strict":"loose"].exec(f),d={},c=14;while(c--){d[e.key[c]]=a[c]||""}switch(b){case"PHP_URL_SCHEME":return d.protocol;case"PHP_URL_HOST":return d.host;case"PHP_URL_PORT":return d.port;case"PHP_URL_USER":return d.user;case"PHP_URL_PASS":return d.password;case"PHP_URL_PATH":return d.path;case"PHP_URL_QUERY":return d.query;case"PHP_URL_FRAGMENT":return d.anchor;default:var g={};if(d.protocol!==""){g.scheme=d.protocol}if(d.host!==""){g.host=d.host}if(d.port!==""){g.port=d.port}if(d.user!==""){g.user=d.user}if(d.password!==""){g.pass=d.password}if(d.path!==""){g.path=d.path}if(d.query!==""){g.query=d.query}if(d.anchor!==""){g.fragment=d.anchor}return g}}var videoWidth=0;var videoHeight=0;$.fn.incomLinker=function(){var a=jQuery;a(this).each(function(){var f,b,j,k,h;function e(l){return l.replace("/","")}function g(o,l,p){var q,m;q=parseInt(e(p),10);m=a('<object width="'+videoWidth+'" height="'+videoHeight+'"><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="http://vimeo.com/moogaloop.swf?clip_id='+q+'&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=0&amp;show_portrait=0&amp;color=a8b6c2&amp;fullscreen=1" /><embed src="http://vimeo.com/moogaloop.swf?clip_id='+q+'&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=0&amp;show_portrait=0&amp;color=a8b6c2&amp;fullscreen=1" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="'+videoWidth+'" height="'+videoHeight+'"></embed></object>').insertAfter(o);o.remove();m.addClass("incom-linker-video")}function c(p,q,r){var m,l,o;if(q!==undefined&&q.split){m=q.split("=");if(m.length===2){l=m[1]}}if(l===undefined&&r!==undefined){l=r.replace("/","")}else{return}o=a('<iframe width="'+videoWidth+'" height="'+videoHeight+'" src="http://www.youtube.com/embed/'+l+'" frameborder="0" allowfullscreen></iframe>').insertAfter(p);p.remove();o.addClass("incom-linker-video")}function d(p,r){var s,q,l,o,m;s=r.split("/");q=-2;l=-1;for(o=0;o<s.length;o+=1){if(s[o]==="sets"&&(o+1)<s.length){l=s[o+1];break}}if(l===-1){return}m=a('<iframe align="center" src="http://www.flickr.com/slideShow/index.gne?group_id=&user_id=&set_id='+l+'&tags=" frameBorder="0" width="'+videoWidth+'" height="'+videoHeight+'" scrolling="no"></iframe>').insertAfter(p);p.remove();m.addClass("incom-linker-flickr")}f=a(this).attr("href");b=parse_url(f);if(b&&b.host){j=b.host.replace("www.","");k=b.path;h=b.query;switch(j){case"vimeo.com":g(a(this),b,k);break;case"youtube.com":c(a(this),h);break;case"youtu.be":c(a(this),h,k);break;case"flickr.com":d(a(this),k);break;default:a(this).addClass("incom-linker-touched");break}}else{a(this).addClass("incom-linker-touched")}});return a(this)};function parseLinks(){videoWidth=474;videoHeight=400;if($("#home-workspaces-wrapper").length){videoWidth=218;videoHeight=168}$(".post p a").incomLinker();$(".post-comment p a").incomLinker()}$(document).ready(function(){parseLinks()});mySettings={previewParserPath:"",onShiftEnter:{keepDefault:false,openWith:"\n\n"},markupSet:[{name:"Heading",key:"1",placeHolder:"Your title here...",closeWith:function(a){return markdownTitle(a,"=")}},{separator:"---------------"},{name:"Bold",key:"B",openWith:"**",closeWith:"**"},{name:"Italic",key:"I",openWith:"_",closeWith:"_"},{separator:"---------------"},{name:"Bulleted List",openWith:"- "},{name:"Numeric List",openWith:function(a){return a.line+". "}},{separator:"---------------"},{name:"Link",key:"L",openWith:"[",closeWith:']([![Url:!:http://]!] "[![Title]!]")',placeHolder:"Your text to link here..."},{separator:"---------------"},{name:"Quotes",openWith:"> "},{name:"Code Block / Code",openWith:"(!(\t|!|`)!)",closeWith:"(!(`)!)"}]};function markdownTitle(a,b){heading="";n=$.trim(a.selection||a.placeHolder).length;for(i=0;i<n;i++){heading+=b}return"\n"+heading}function checkNetworkUser(a){var b=baseUrl+"api/userExists.json";var c={};c.email=a.email;c.clientKey="incom-exchange";$.getJSON(b,c,function(d){if(!d.check[0].taken){if($("#overlay-welcome-networkuser").size()==0){$("body").append('<div id="overlay-welcome-networkuser"></div>')}$("#overlay-welcome-networkuser").load(baseUrl+"form/welcome-user",{ajaxCall:true},function(){$("#overlay-welcome-networkuser").fadeIn("fast");$("#overlay-welcome-networkuser .go-back").click(function(e){e.preventDefault();$("#overlay-welcome-networkuser").hide()});$("#network_user_id").val(a.id);$("#network_user_name").html(a.name);$("#network_user_name").css({"background-image":"URL("+a.iconUrl+")"});$(".cancel-network-user").click(function(){var e=baseUrl+"action/disable-network-user";var f={};f.email=a.email;$.getJSON(e,f,function(g){if(g.success){document.location.reload()}})});$("#ja").click(function(e){e.preventDefault();$("#passwort").show();$("#trans-pass").focus();$("#ja_nein").hide();$("#submitbuttons").show()})})}else{}})}function buildLoginShortcut(a){}function logUserFromKey(a){var b=baseUrl+"action/login-network-user";var c={};c.email=a.email;$.getJSON(b,c,function(d){if(!d.success){}})}function getUserInfoFromNetwork(b){var a=b.url+"action/get-userFromKey?callback=?&prefix="+b.prefix;var c={};c.key=b.visitingUserKey;c.clientKey="incom-exchange";c.jsonp="jquery";c.mode="basic";$.getJSON(a,c,function(d){if(d.id>1){checkNetworkUser(d)}})}function checkForUpdates(){var a=baseUrl+"action/update-network-user";var b={};$.getJSON(a,b,function(c){if(!c.success){}})}function updateRemoteUserProfil(c,e,b){var a=c.url+"action/update-network-user-home?email="+e+"&callback=?";var d={};d.updateDomainPrefix=b;$.getJSON(a,d,function(f){if(!f.success){}})}var original_suchtext="";var original_username="";var original_passwd="";$(document).ready(function(){$("a.sendmsg, a.sendmsgall").click(function(a){a.preventDefault();if($("#overlay-sendmsg").size()==0){$("body").append('<div id="overlay-sendmsg"></div>')}$("#overlay-sendmsg").hide().css("top",($(this).offset().top-89)+"px");$("#overlay-sendmsg").load(this.href,{ajaxCall:true},function(){$("#overlay-sendmsg").fadeIn("fast");$("#overlay-sendmsg-message").focus();$("#overlay-sendmsg .go-back").click(function(b){b.preventDefault();$("#overlay-sendmsg").hide()});$("#overlay-sendmsg form").submit(function(d){d.preventDefault();var c={ajaxCall:true};var b=$("#overlay-sendmsg :input").serializeArray();jQuery.each(b,function(e,f){c[f.name]=f.value});$.post($("#overlay-sendmsg form").attr("action"),c,function(e){$("#overlay-sendmsg .form-wrapper").slideUp("fast");$("#overlay-sendmsg").append('<div id="sendmsg-result">'+e+"</div>").animate({opacity:1},1000).fadeOut("slow")})})})});original_suchtext=$("#globalsearch #s").val();original_username=$("#header-myincom-login #email").val();original_passwd=$("#header-myincom-login #password").val();$("#globalsearch #s").focus(function(a){if($(this).val()===original_suchtext&&!$(this).hasClass("reset-off")){$(this).val("")}});$("#header-myincom-login #email").focus(function(a){if($(this).val()===original_username){$(this).val("")}});$("#header-myincom-login #password").focus(function(a){if($(this).val()===original_passwd){$(this).val("")}});$("#show-shortcuts").click(showShortcuts);$("#hide-shortcuts").click(hideShortcuts)});$.postJSON=function(a,b,c){$.post(a,b,c,"json")};function showShortcuts(a){a.preventDefault();$(this).attr("id","hide-shortcuts").unbind("click").click(hideShortcuts);$.postJSON(this.href,{ajaxCall:true},function(d){$("#hide-shortcuts").attr("href",d.hideAction);var b=$('<ul class="separated"></ul>');if(d.workspaces&&d.workspaces.length>0){for(var c=0;c<d.workspaces.length;c+=1){b.append('<li><a href="'+d.workspaces[c].url+'">'+d.workspaces[c].name+"</a></li>")}}else{b.append('<li><a href="#">Du bist nirgends Zaungast.</a></li>')}$("li:last",b).addClass("last");$("li#workspace-list").append(b)})}function hideShortcuts(a){a.preventDefault();$(this).attr("id","show-shortcuts").unbind("click").click(showShortcuts);$.postJSON(this.href,{ajaxCall:true},function(b){$("#show-shortcuts").attr("href",b.showAction);$("li#workspace-list ul.separated").hide("slow",function(){$(this).remove()})})}window.log=function(){log.history=log.history||[];log.history.push(arguments);arguments.callee=arguments.callee.caller;if(this.console){console.log(Array.prototype.slice.call(arguments))}};(function(e){function h(){}for(var g="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),f;f=g.pop();){e[f]=e[f]||h}})(window.console=window.console||{});(function(a){a.fn.tipsy=function(b){b=a.extend({fade:false,gravity:"n"},b||{});var c=null,d=false;this.hover(function(){a.data(this,"cancel.tipsy",true);var e=a.data(this,"active.tipsy");if(!e){e=a('<div class="tipsy"><div class="tipsy-inner">'+a(this).attr("title")+"</div></div>");e.css({position:"absolute",zIndex:100000});a(this).attr("title","");a.data(this,"active.tipsy",e)}var h=a.extend({},a(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var f=e[0].offsetWidth,g=e[0].offsetHeight;switch(b.gravity.charAt(0)){case"n":e.css({top:h.top+h.height,left:h.left+h.width/2-f/2}).addClass("tipsy-north");break;case"s":e.css({top:h.top-g,left:h.left+h.width/2-f/2}).addClass("tipsy-south");break;case"e":e.css({top:h.top+h.height/2-g/2,left:h.left-f}).addClass("tipsy-east");break;case"w":e.css({top:h.top+h.height/2-g/2,left:h.left+h.width}).addClass("tipsy-west");break}if(b.fade){e.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:1})}else{e.css({visibility:"visible"})}},function(){a.data(this,"cancel.tipsy",false);var e=this;setTimeout(function(){if(a.data(this,"cancel.tipsy")){return}var f=a.data(e,"active.tipsy");if(b.fade){f.stop().fadeOut(function(){a(this).remove()})}else{f.remove()}},100)})}})(jQuery);